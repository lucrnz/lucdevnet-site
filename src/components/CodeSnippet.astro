---
type Language =
  | "js"
  | "ts"
  | "py"
  | "go"
  | "cs"
  | "jsx"
  | "tsx"
  | "html"
  | "css"
  | "scss"
  | "json"
  | "yaml"
  | "sh"
  | "dockerfile"
  | "misc"
  | "cfg"
  | "ini";

export interface Props {
  name?: string;
  language?: Language;
  runnable?: boolean;
}

const { name, language = "js", runnable: allowRunning = false } = Astro.props;

const prettyPrintLanguage: Record<Language, string> = {
  js: "JavaScript",
  ts: "TypeScript",
  py: "Python",
  go: "Go",
  cs: "C#",
  jsx: "JSX",
  tsx: "TSX",
  html: "HTML",
  css: "CSS",
  scss: "SCSS",
  json: "JSON",
  yaml: "YAML",
  sh: "Shell",
  dockerfile: "Dockerfile",
  misc: "Note",
  cfg: "Config file",
  ini: "INI file"
};

const runnableLanguages = ["js", "ts"];
const runnable = runnableLanguages.includes(language) && allowRunning;
---

<form
  class="flex flex-col gap-2 my-6 rounded-lg border border-gray-600"
  data-code-snippet={JSON.stringify({ runnable, language })}
>
  <div class="px-4 py-2 flex flex-row justify-between items-center not-prose">
    <div class="flex flex-row gap-2 items-center">
      {
        (language === "jsx" || language === "tsx") && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 512 512"
          >
            <path
              fill="currentColor"
              d="M300.703 254.826c0-35.044-37.946-57.065-68.14-39.543c-30.192 17.521-30.192 61.564 0 79.086c30.194 17.521 68.14-4.5 68.14-39.543m104.01-84.17c30.06-143.69-36.073-188.782-148.5-84.772c-105.814-99.2-181.166-67.937-149.102 84.17c-147.86 44.576-138.064 128.486 1.203 171.347c-31.864 140.083 27.656 191.186 147.899 85.372C372.848 531.384 434.75 482.405 402.909 340.8c151.907-51.504 138.28-126.054 1.804-170.143m-20.441-5.411c-23.831-5.376-46.89-9.289-70.343-11.424c-12.356-18.067-26.748-36.115-43.287-52.906c90.138-86.46 143.263-59.445 113.63 64.33M151.602 282.48c8.917 19.039 20.641 36.474 29.459 51.104c-14.359-1.469-29.827-3.699-46.294-6.614a1307 1307 0 0 1 16.834-44.49m-1.203-51.704c-6.56-15.746-12.545-30.943-17.435-45.091c16.998-3.524 33.656-6.723 48.097-7.816c-10.748 16.884-20.957 34.537-30.662 52.907m12.625 26.453c14.702-29.443 30.254-57.391 47.496-82.366c30.594-1.76 60.863-1.604 90.784.601c16.781 23.383 32.443 51.33 47.496 81.765c-11.264 23.278-27.259 50.104-45.692 78.76c-30.778 2.33-62.336 2.008-94.391 0c-16.247-24.89-31.505-51.107-45.693-78.76m197.199 25.251c5.838 14.167 11.233 28.606 16.233 43.288a455 455 0 0 1-45.693 7.215c10.295-15.95 20.06-32.885 29.46-50.503m-29.46-104.61c16.393 2.243 32.229 5.045 47.496 8.416a484 484 0 0 1-17.435 44.49c-9.306-18.354-19.297-36.019-30.06-52.907m-46.293-26.454c-18.725-.735-37.773-.711-57.116 0c8.468-11.137 17.906-22.77 28.258-34.87c10.087 10.888 19.645 22.608 28.858 34.87m-43.288-50.502c-16.539 16.791-30.93 34.238-43.287 52.305c-23.453 2.135-47.113 6.048-70.943 11.423c-28.258-125.654 24.093-150.189 114.23-63.728M113.725 321.56c-125.253-37.676-119.241-96.394-1.203-131.064c7.221 21.91 15.962 44.163 25.853 65.532c-9.61 22.1-18.119 44.797-24.65 65.532m15.631 25.251c21.243 5.211 43.755 7.712 67.337 10.221c14.188 20.024 28.882 38.64 44.49 54.71c-91.786 87.978-142.953 56.014-111.827-64.93m126.256 49.901c-10.877-11.263-21.032-24.025-30.662-37.876c21.467.452 42.2.502 61.925 0a322 322 0 0 1-31.263 37.876m15.03 15.03c16.747-18.195 31.51-36.64 44.49-55.311c22.154-1.63 44.6-5.034 67.336-10.22c31.408 128.733-25.62 147.742-111.826 65.532m126.856-91.384c-6.44-20.735-14.572-42.23-24.048-64.33a611 611 0 0 0 25.25-64.931c115.234 34.87 124.452 90.583-1.202 129.261"
            />
          </svg>
        )
      }
      {
        language === "js" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M0 0h24v24H0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873c-.736-.345-1.554-.585-1.797-1.14c-.091-.33-.105-.51-.046-.705c.15-.646.915-.84 1.515-.66c.39.12.75.42.976.9c1.034-.676 1.034-.676 1.755-1.125c-.27-.42-.404-.601-.586-.78c-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005c-1.14 1.291-.811 3.541.569 4.471c1.365 1.02 3.361 1.244 3.616 2.205c.24 1.17-.87 1.545-1.966 1.41c-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109c1.74 1.756 6.09 1.666 6.871-1.004c.029-.09.24-.705.074-1.65zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805c0 1.232.063 2.363-.138 2.711c-.33.689-1.18.601-1.566.48c-.396-.196-.597-.466-.83-.855c-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517c.855.51 2.004.675 3.207.405c.783-.226 1.458-.691 1.811-1.411c.51-.93.402-2.07.397-3.346c.012-2.054 0-4.109 0-6.179z"
            />
          </svg>
        )
      }
      {
        language === "ts" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M1.125 0C.502 0 0 .502 0 1.125v21.75C0 23.498.502 24 1.125 24h21.75c.623 0 1.125-.502 1.125-1.125V1.125C24 .502 23.498 0 22.875 0zm17.363 9.75q.918 0 1.627.111a6.4 6.4 0 0 1 1.306.34v2.458a4 4 0 0 0-.643-.361a5 5 0 0 0-.717-.26a5.5 5.5 0 0 0-1.426-.2q-.45 0-.819.086a2.1 2.1 0 0 0-.623.242q-.254.156-.393.374a.9.9 0 0 0-.14.49q0 .294.156.529q.156.234.443.444c.287.21.423.276.696.41q.41.203.926.416q.705.296 1.266.628q.561.333.963.753q.402.418.614.957q.213.538.214 1.253q0 .986-.373 1.656a3 3 0 0 1-1.012 1.085a4.4 4.4 0 0 1-1.487.596q-.85.18-1.79.18a10 10 0 0 1-1.84-.164a5.5 5.5 0 0 1-1.512-.493v-2.63a5.03 5.03 0 0 0 3.237 1.2q.5 0 .872-.09q.373-.09.623-.25q.249-.162.373-.38a1.02 1.02 0 0 0-.074-1.089a2.1 2.1 0 0 0-.537-.5a5.6 5.6 0 0 0-.807-.444a28 28 0 0 0-1.007-.436q-1.377-.575-2.053-1.405t-.676-2.005q0-.92.369-1.582q.368-.662 1.004-1.089a4.5 4.5 0 0 1 1.47-.629a7.5 7.5 0 0 1 1.77-.201m-15.113.188h9.563v2.166H9.506v9.646H6.789v-9.646H3.375z"
            />
          </svg>
        )
      }
      {
        language === "py" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 15 15"
          >
            <path
              fill="none"
              stroke="currentColor"
              d="M6 2.5h1M4.5 4V1.5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1h-4a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1V11M8 4.5H1.5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h3m2.5-1h6.5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1h-3m-2.5 9h1"
            />
          </svg>
        )
      }
      {
        language === "go" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M1.811 10.231c-.047 0-.058-.023-.035-.059l.246-.315c.023-.035.081-.058.128-.058h4.172c.046 0 .058.035.035.07l-.199.303c-.023.036-.082.07-.117.07zM.047 11.306c-.047 0-.059-.023-.035-.058l.245-.316c.023-.035.082-.058.129-.058h5.328c.047 0 .07.035.058.07l-.093.28c-.012.047-.058.07-.105.07zm2.828 1.075c-.047 0-.059-.035-.035-.07l.163-.292c.023-.035.07-.07.117-.07h2.337c.047 0 .07.035.07.082l-.023.28c0 .047-.047.082-.082.082zm12.129-2.36c-.736.187-1.239.327-1.963.514c-.176.046-.187.058-.34-.117c-.174-.199-.303-.327-.548-.444c-.737-.362-1.45-.257-2.115.175c-.795.514-1.204 1.274-1.192 2.22c.011.935.654 1.706 1.577 1.835c.795.105 1.46-.175 1.987-.77c.105-.13.198-.27.315-.434H10.47c-.245 0-.304-.152-.222-.35c.152-.362.432-.97.596-1.274a.32.32 0 0 1 .292-.187h4.253c-.023.316-.023.631-.07.947a5 5 0 0 1-.958 2.29c-.841 1.11-1.94 1.8-3.33 1.986c-1.145.152-2.209-.07-3.143-.77c-.865-.655-1.356-1.52-1.484-2.595c-.152-1.274.222-2.419.993-3.424c.83-1.086 1.928-1.776 3.272-2.02c1.098-.2 2.15-.07 3.096.571c.62.41 1.063.97 1.356 1.648c.07.105.023.164-.117.2m3.868 6.461c-1.064-.024-2.034-.328-2.852-1.029a3.67 3.67 0 0 1-1.262-2.255c-.21-1.32.152-2.489.947-3.529c.853-1.122 1.881-1.706 3.272-1.95c1.192-.21 2.314-.095 3.33.595c.923.63 1.496 1.484 1.648 2.605c.198 1.578-.257 2.863-1.344 3.962c-.771.783-1.718 1.273-2.805 1.495c-.315.06-.63.07-.934.106m2.78-4.72c-.011-.153-.011-.27-.034-.387c-.21-1.157-1.274-1.81-2.384-1.554c-1.087.245-1.788.935-2.045 2.033c-.21.912.234 1.835 1.075 2.21c.643.28 1.285.244 1.905-.07c.923-.48 1.425-1.228 1.484-2.233z"
            />
          </svg>
        )
      }
      {
        language === "cs" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 128 128"
          >
            <path
              fill="currentColor"
              d="m117.5 33.5l.3-.2c-.6-1.1-1.5-2.1-2.4-2.6L67.1 2.9c-.8-.5-1.9-.7-3.1-.7s-2.3.3-3.1.7l-48 27.9c-1.7 1-2.9 3.5-2.9 5.4v55.7c0 1.1.2 2.3.9 3.4l-.2.1c.5.8 1.2 1.5 1.9 1.9l48.2 27.9c.8.5 1.9.7 3.1.7s2.3-.3 3.1-.7l48-27.9c1.7-1 2.9-3.5 2.9-5.4V36.1c.1-.8 0-1.7-.4-2.6m-53.5 70c-21.8 0-39.5-17.7-39.5-39.5S42.2 24.5 64 24.5c14.7 0 27.5 8.1 34.3 20l-13 7.5C81.1 44.5 73.1 39.5 64 39.5c-13.5 0-24.5 11-24.5 24.5s11 24.5 24.5 24.5c9.1 0 17.1-5 21.3-12.4l12.9 7.6c-6.8 11.8-19.6 19.8-34.2 19.8M115 62h-3.2l-.9 4h4.1v5h-5l-1.2 6h-4.9l1.2-6h-3.8l-1.2 6h-4.8l1.2-6H94v-5h3.5l.9-4H94v-5h5.3l1.2-6h4.9l-1.2 6h3.8l1.2-6h4.8l-1.2 6h2.2zm-12.7 4h3.8l.9-4h-3.8z"
            />
          </svg>
        )
      }
      {
        language === "html" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="m3 2l1.578 17.824L12 22l7.467-2.175L21 2zm14.049 6.048H9.075l.172 2.016h7.697l-.626 6.565l-4.246 1.381l-4.281-1.455l-.288-2.932h2.024l.16 1.411l2.4.815l2.346-.763l.297-3.005H7.416l-.562-6.05h10.412z"
            />
          </svg>
        )
      }
      {
        language === "css" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 16 16"
          >
            <path
              fill="currentColor"
              d="m2.381.758l-.537 2.686h10.934l-.342 1.735H1.496l-.53 2.686h10.933l-.61 3.063l-4.406 1.46l-3.819-1.46l.261-1.329H.639L0 12.823l6.316 2.417l7.281-2.417L16 .757z"
            />
          </svg>
        )
      }

      {
        language === "scss" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 32 32"
          >
            <path
              fill="currentColor"
              d="M16.171 18.7c-.481.221-1.008.509-2.063 1.088c-.4.225-.818.45-1.207.662c-.027-.027-.055-.061-.082-.089c-2.087-2.23-5.947-3.805-5.783-6.8c.061-1.091.436-3.955 7.413-7.433c5.742-2.83 10.311-2.046 11.1-.307c1.134 2.479-2.449 7.092-8.379 7.761a4.47 4.47 0 0 1-3.751-.948c-.314-.341-.361-.361-.477-.293c-.191.1-.068.409 0 .586a3.5 3.5 0 0 0 2.141 1.684a11.4 11.4 0 0 0 6.956-.689c3.594-1.391 6.4-5.258 5.578-8.5c-.825-3.287-6.281-4.371-11.443-2.537a26 26 0 0 0-8.79 5.047c-2.844 2.66-3.294 4.972-3.11 5.94c.662 3.437 5.4 5.674 7.3 7.331q-.148.08-.259.143c-.948.471-4.562 2.36-5.463 4.358c-1.023 2.264.164 3.887.948 4.105a5.83 5.83 0 0 0 6.281-2.544a6.3 6.3 0 0 0 .559-5.8a5 5 0 0 1 .716-.477c.484-.286.945-.568 1.354-.786a10.5 10.5 0 0 1 4.475-.989c3.246.382 3.887 2.407 3.764 3.26a2.16 2.16 0 0 1-1.03 1.459c-.225.143-.3.191-.28.293c.027.15.136.143.327.116a2.535 2.535 0 0 0 1.766-2.257c.1-2-1.807-4.194-5.183-4.174a7.8 7.8 0 0 0-2.946.587q-.225.093-.437.2Zm-4.825 7.839c-1.078 1.173-2.578 1.616-3.226 1.241c-.7-.4-.423-2.135.9-3.376a17 17 0 0 1 2.53-1.889c.157-.1.389-.232.668-.4l.075-.041l.164-.1a4.66 4.66 0 0 1-1.111 4.565"
            />
          </svg>
        )
      }
      {
        language === "json" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M12.043 23.968c.479-.004.953-.029 1.426-.094a11.8 11.8 0 0 0 3.146-.863a12.4 12.4 0 0 0 3.793-2.542a12 12 0 0 0 2.44-3.427a11.8 11.8 0 0 0 1.02-3.476c.149-1.16.135-2.346-.045-3.499a12 12 0 0 0-.793-2.788a11 11 0 0 0-.854-1.617c-1.168-1.837-2.861-3.314-4.81-4.3a13 13 0 0 0-2.172-.87h-.005c.119.063.24.132.345.201c.12.074.239.146.351.225a9 9 0 0 1 1.559 1.33c1.063 1.145 1.797 2.548 2.218 4.041c.284.982.434 1.998.495 3.017c.044.743.044 1.491-.047 2.229c-.149 1.27-.554 2.51-1.228 3.596a7.5 7.5 0 0 1-1.903 2.084c-1.244.928-2.877 1.482-4.436 1.114a4 4 0 0 1-.748-.258a4.7 4.7 0 0 1-.779-.45a6 6 0 0 1-1.244-1.105a6.5 6.5 0 0 1-1.049-1.747a7.4 7.4 0 0 1-.494-2.54c-.03-1.273.225-2.553.854-3.67a6.4 6.4 0 0 1 1.663-1.918c.225-.178.464-.333.704-.479l.016-.007a5.1 5.1 0 0 0-1.441-.12a5 5 0 0 0-1.228.24c-.359.12-.704.27-1.019.45a6 6 0 0 0-.733.494c-.211.18-.42.36-.615.555c-1.123 1.153-1.768 2.682-2.022 4.256c-.15.973-.15 1.96-.091 2.95c.105 1.395.391 2.787.945 4.062a8.5 8.5 0 0 0 1.348 2.173a8.14 8.14 0 0 0 3.132 2.23a8 8 0 0 0 2.113.54c.074.015.149.015.209.015zm-2.934-.398a4 4 0 0 1-.45-.228a8.5 8.5 0 0 1-2.038-1.534c-1.094-1.137-1.827-2.566-2.247-4.08a15.2 15.2 0 0 1-.495-3.172a12 12 0 0 1 .046-2.082c.135-1.257.495-2.501 1.124-3.58a6.9 6.9 0 0 1 1.783-2.053a6.2 6.2 0 0 1 1.633-.9a5.36 5.36 0 0 1 3.522-.045c.029 0 .029 0 .045.03c.015.015.045.015.06.03c.045.016.104.045.165.074c.239.12.479.271.704.42a6.3 6.3 0 0 1 2.097 2.502c.42.914.615 1.934.631 2.938c.014 1.079-.18 2.157-.645 3.146a6.4 6.4 0 0 1-2.638 2.832c.09.03.18.045.271.075c.225.044.449.074.688.074c1.468.045 2.892-.66 3.94-1.647q.293-.27.54-.585c.225-.27.435-.54.614-.823c.239-.375.435-.75.614-1.154a8 8 0 0 0 .509-1.664c.196-1.004.211-2.022.149-3.026c-.135-2.022-.673-4.045-1.842-5.724a9 9 0 0 0-.555-.719a10 10 0 0 0-1.063-1.034a8.5 8.5 0 0 0-1.363-.915a10 10 0 0 0-1.692-.598l-.3-.06c-.209-.03-.42-.044-.634-.06a9 9 0 0 0-1.015.016c-.704.045-1.412.16-2.112.337C5.799 1.227 2.863 3.566 1.3 6.67A11.8 11.8 0 0 0 .238 9.801a11.8 11.8 0 0 0-.104 3.775c.12 1.02.374 2.023.778 2.977c.227.57.511 1.124.825 1.648c1.094 1.783 2.683 3.236 4.51 4.24c.688.39 1.408.69 2.157.944c.226.074.45.15.689.21z"
            />
          </svg>
        )
      }
      {
        language === "yaml" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 16 16"
          >
            <path
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M2.5 1.5h3l3 4l3-4h3l-9 13h-3L7 8z"
            />
          </svg>
        )
      }
      {
        language === "sh" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M5 9h2.31l.32-3h2l-.32 3h2l.32-3h2l-.32 3H15v2h-1.9l-.2 2H15v2h-2.31l-.32 3h-2l.32-3h-2l-.32 3h-2l.32-3H5v-2h1.9l.2-2H5zm4.1 2l-.2 2h2l.2-2M19 6h-2v8h2m0 2h-2v2h2Z"
            />
          </svg>
        )
      }
      {
        language === "dockerfile" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 15 15"
          >
            <path
              fill="currentColor"
              d="M.5 5.5V5H0v.5zm2-2V3H2v.5zm4-2V1H6v.5zm2 0H9V1h-.5zm4 6H12V8h.5zM1 7.5v-2H0v2zm2 0v-4H2v4zM2.5 4h6V3h-6zM8 3.5v4h1v-4zm-3 4v-4H4v4zm2 0v-6H6v6zM6.5 2h2V1h-2zM8 1.5v2h1v-2zm5.736 8.5H15V9h-1.264zM10 5v.5h1V5zm2 1.5v1h1v-1zm.5 1.5h1V7h-1zm1.5.5v1h1v-1zm-.5-.5a.5.5 0 0 1 .5.5h1A1.5 1.5 0 0 0 13.5 7zm-2-2a.5.5 0 0 1 .5.5h1A1.5 1.5 0 0 0 11.5 5zM3 10h1V9H3zm5.5-3h-8v1h8zM0 7.5v1h1v-1zM5.5 14h.528v-1H5.5zm.528 0a7.74 7.74 0 0 0 6.23-3.15l-.805-.593A6.74 6.74 0 0 1 6.028 13zM0 8.5A5.5 5.5 0 0 0 5.5 14v-1A4.5 4.5 0 0 1 1 8.5zM.5 6h11V5H.5zm9.5-.5A1.5 1.5 0 0 1 8.5 7v1A2.5 2.5 0 0 0 11 5.5zM13.736 9c-.96 0-1.769.558-2.283 1.257l.806.593c.383-.522.922-.85 1.477-.85z"
            />
          </svg>
        )
      }
      {
        language === "misc" && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <g
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              color="currentColor"
            >
              <>
                <path d="m11 22l-1.478-2.354c-1.03-1.64-1.545-2.46-2.361-2.607c-1.33-.24-2.703.665-3.661 1.47" />
                <path d="M3.5 9v7.028c0 1.203 0 1.804.299 2.287c.298.484.836.753 1.912 1.29l3.944 1.973c.841.42.85.422 1.79.422H14.5c2.828 0 4.243 0 5.121-.879c.879-.878.879-2.293.879-5.121V9c0-2.828 0-4.243-.879-5.121C18.743 3 17.328 3 14.5 3h-5c-2.828 0-4.243 0-5.121.879C3.5 4.757 3.5 6.172 3.5 9M12 9H8m8 5H8m9-12v2m-5-2v2M7 2v2" />
              </>
            </g>
          </svg>
        )
      }
      {
        (language === "cfg" || language === "ini") && (
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
          >
            <g
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              color="currentColor"
            >
              <>
                <path d="M2.256 15.632c.034-.323.268-.583.736-1.104l1.031-1.153c.252-.32.431-.875.431-1.375s-.179-1.056-.43-1.375L2.991 9.472c-.468-.52-.702-.781-.736-1.104s.14-.627.49-1.234l.494-.857c.373-.648.56-.972.878-1.1c.317-.13.676-.028 1.395.176l1.22.343c.459.106.94.046 1.358-.169l.337-.194a2 2 0 0 0 .788-.968l.334-.997c.22-.66.33-.99.591-1.18C10.403 2 10.75 2 11.444 2h1.115c.694 0 1.042 0 1.303.189s.371.519.59 1.179l.335.997a2 2 0 0 0 .788.968l.337.194c.418.215.9.275 1.358.17l1.22-.344c.719-.204 1.078-.306 1.395-.177c.318.13.505.453.878 1.101l.493.857c.35.607.525.91.491 1.234s-.268.583-.736 1.104l-1.031 1.153c-.252.319-.431.875-.431 1.375s.179 1.056.43 1.375l1.032 1.153c.468.52.702.781.736 1.104s-.14.627-.49 1.234l-.494.857c-.373.648-.56.972-.878 1.1c-.317.13-.676.028-1.395-.176l-1.22-.343a2 2 0 0 0-1.359.169l-.336.194c-.36.23-.636.57-.788.968l-.334.997c-.22.66-.33.99-.591 1.18c-.261.188-.609.188-1.303.188h-1.115c-.694 0-1.041 0-1.303-.189c-.261-.189-.371-.518-.59-1.178" />
                <path d="M2.737 18.78c1.08-1.08 4.752-4.716 5.112-5.136c.381-.444.072-1.044.256-2.904c.089-.9.282-1.574.836-2.076c.66-.624 1.2-.624 3.06-.666c1.62.042 1.812-.138 1.98.282c.12.3-.24.48-.672.96c-.96.96-1.524 1.44-1.578 1.74c-.39 1.32 1.146 2.1 1.986 1.26c.318-.318 1.788-1.8 1.932-1.92c.108-.096.367-.092.492.06c.108.106.12.12.108.6c-.01.444-.006 1.082-.004 1.74c.001.852-.044 1.8-.404 2.28c-.72 1.08-1.92 1.14-3 1.188c-1.02.06-1.86-.048-2.124.144c-.216.108-1.356 1.308-2.736 2.688l-2.46 2.46c-2.04 1.62-4.284-.9-2.784-2.7" />
              </>
            </g>
          </svg>
        )
      }
      {name ?? prettyPrintLanguage[language]}
    </div>

    <div class="flex flex-row gap-2 items-center">
      <button
        data-copy-btn="normal"
        class="w-fit transition-all duration-200 ease-in-out flex flex-row gap-2 items-center hover:text-cyan-600 hover:dark:text-cyan-400 cursor-pointer"
      >
        <div data-state="normal">
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
            ><path
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 9V6.2c0-1.12 0-1.68.218-2.108c.192-.377.497-.682.874-.874C10.52 3 11.08 3 12.2 3h5.6c1.12 0 1.68 0 2.108.218a2 2 0 0 1 .874.874C21 4.52 21 5.08 21 6.2v5.6c0 1.12 0 1.68-.218 2.108a2 2 0 0 1-.874.874C19.48 15 18.92 15 17.803 15H15M9 9H6.2c-1.12 0-1.68 0-2.108.218a2 2 0 0 0-.874.874C3 10.52 3 11.08 3 12.2v5.6c0 1.12 0 1.68.218 2.108a2 2 0 0 0 .874.874c.427.218.987.218 2.105.218h5.607c1.117 0 1.676 0 2.104-.218a2 2 0 0 0 .874-.874c.218-.428.218-.987.218-2.105V15M9 9h2.8c1.12 0 1.68 0 2.108.218a2 2 0 0 1 .874.874c.218.427.218.987.218 2.105V15"
            ></path></svg
          >
          <span>Copy code</span>
        </div>
        <div data-state="copied">
          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="1em"
            height="1em"
            viewBox="0 0 24 24"
            ><path
              fill="currentColor"
              d="m9.55 18l-5.7-5.7l1.425-1.425L9.55 15.15l9.175-9.175L20.15 7.4z"
            ></path></svg
          >
          <span>Copied!</span>
        </div>
      </button>
      {
        runnable && (
          <button
            data-run-btn
            type="submit"
            class="w-fit transition-all flex flex-row gap-2 items-center duration-200 ease-in-out cursor-pointer hover:text-cyan-600 hover:dark:text-cyan-400 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <svg
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              width="1em"
              height="1em"
              viewBox="0 0 512 512"
            >
              <path
                fill="currentColor"
                d="M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440"
              />
            </svg>
            <span>Run code</span>
          </button>
        )
      }
    </div>
  </div>
  <div class="contents" data-code-container>
    <slot />
  </div>

  {
    runnable && (
      <div
        class="not-prose hidden data-[script-console=visible]:flex flex-col rounded-lg bg-white text-[#24292e] dark:bg-[#27272A] dark:text-slate-200 pl-4 text-sm py-2"
        data-script-console
      >
        <pre data-script-output />
        <pre data-script-stats />
      </div>
    )
  }
</form>

<style is:global>
  [data-code-snippet] [data-code-container] .astro-code {
    margin: 0;
  }

  [data-code-snippet] [data-copy-btn="normal"] [data-state="normal"] {
    display: contents;
  }

  [data-code-snippet] [data-copy-btn="normal"] [data-state="copied"] {
    display: none;
  }

  [data-code-snippet] [data-copy-btn="copied"] [data-state="normal"] {
    display: none;
  }

  [data-code-snippet] [data-copy-btn="copied"] [data-state="copied"] {
    display: contents;
  }
</style>

<script>
  import type { ExecuteCodeSnippetRequirements } from "~/types/codeSnippet";
  let execFn:
    | ((req: ExecuteCodeSnippetRequirements) => Promise<void>)
    | undefined;

  const executeCodeSnippet = async (req: ExecuteCodeSnippetRequirements) => {
    if (!execFn) {
      const importData = await import("~/scripts/executeCodeSnippet.ts");
      execFn = importData.default;
    }
    return await execFn(req);
  };

  const forms = Array.from(
    document.querySelectorAll("[data-code-snippet]")
  ) as HTMLFormElement[];

  for (const form of forms) {
    const metadata = JSON.parse(form.dataset.codeSnippet!) as {
      runnable: boolean;
    };
    const codeElement = form.querySelector(
      "[data-code-container] .astro-code > code"
    )! as HTMLElement;
    const copyBtn = form.querySelector("[data-copy-btn]")! as HTMLButtonElement;

    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      if (!metadata.runnable) {
        return;
      }

      await executeCodeSnippet({
        form,
        codeElement
      });
    });

    copyBtn.addEventListener("click", async (ev) => {
      ev.preventDefault();
      const code = codeElement.textContent ?? "";
      await navigator.clipboard.writeText(code);

      copyBtn.setAttribute("data-copy-btn", "copied");
      copyBtn.setAttribute("disabled", "disabled");
      setTimeout(() => {
        copyBtn.setAttribute("data-copy-btn", "normal");
        copyBtn.removeAttribute("disabled");
      }, 2000);
    });
  }
</script>
