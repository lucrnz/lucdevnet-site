---
/*
 * SPDX-FileCopyrightText: 2025 Luciano Hillcoat <me@lucdev.net>
 * SPDX-License-Identifier: AGPL-3.0-only
 */

import {
  formatDateTime,
  DateTimeFormattingConfig
} from "~/helpers/formatDateTime";
import type { JobTitle } from "~/types/resume/title";
import type { JobCompany } from "~/types/resume/company";
import type { JobLocation, JobLocationType } from "~/types/resume/location";

export interface Props {
  title: JobTitle;
  companyName: JobCompany;
  startDate: Date;
  endDate?: Date;
  location: JobLocation;
  locationType: JobLocationType;
  projectName?: string;
}

const {
  title,
  companyName,
  startDate,
  endDate,
  location,
  locationType,
  projectName
} = Astro.props as Props;

const dateFormat = DateTimeFormattingConfig.MonthLongYearOnly;

// const timeTotal = prettyPrintDateDifference(roundDateDifference(dateDifference(startDate, endDate ?? new Date())));
---

<div class="flex flex-col mb-2 gap-2">
  <div
    class="flex flex-col sm:flex-row gap-2 items-start sm:justify-between mb-4"
  >
    <div class="flex flex-col gap-2 items-start">
      <h4
        class="text-xl font-medium font-display print:font-serif print:font-bold"
      >
        {companyName}
      </h4>
      <p>
        {projectName ? `${title} - ${projectName} project` : title}
      </p>
    </div>
    <div class="flex flex-col gap-2 items-start sm:items-end">
      <span class="flex items-center gap-2 font-medium">
        {location} ({locationType})
      </span>
      <div class="flex flex-row gap-2 items-start sm:items-end">
        <span class="flex items-center gap-2">
          {
            endDate
              ? `${formatDateTime(startDate, dateFormat)} - ${formatDateTime(endDate, dateFormat)}`
              : `${formatDateTime(startDate, dateFormat)} - Present`
          }
        </span>
      </div>
    </div>
  </div>
  <ul class="flex flex-col gap-2 list-disc list-inside">
    <slot />
  </ul>
</div>
